config: |
  auth:
    enabled: true
  tls:
    enabled: false
  mqtt:
    enabled: true
    host: 10.10.0.200
    user: '{FRIGATE_MQTT_USER}'
    password: '{FRIGATE_MQTT_PASSWORD}'
  record:
    enabled: true
    retain:
      days: 7
      mode: all
    alerts:
      retain:
        days: 30
        mode: active_objects
    detections:
      retain:
        days: 7
        mode: active_objects
  detect:
    enabled: true
    annotation_offset: -1500
  objects:
    track:
      - person
      - car
      - cat
  detectors:
    ov:
      type: openvino
      device: GPU
  model:
    # generated using https://github.com/blakeblackshear/frigate/blob/dev/notebooks/YOLO_NAS_Pretrained_Export.ipynb
    # https://docs.frigate.video/configuration/object_detectors#yolo-nas
    model_type: yolonas
    width: 320
    height: 320
    input_tensor: nchw
    input_pixel_format: bgr
    path: /config/models/yolo_nas_s.onnx
    labelmap_path: /labelmap/coco-80.txt
  go2rtc:
    streams:
      front:
        - rtsp://{FRIGATE_RTSP_USER}:{FRIGATE_RTSP_PASSWORD}@10.10.10.11:554/cam/realmonitor?channel=1&subtype=0
      front_sub:
        - ffmpeg:front#video=h264#width=1280#height=720#raw=-fpsmax 5#hardware=vaapi
      back:
        - rtsp://{FRIGATE_RTSP_USER}:{FRIGATE_RTSP_PASSWORD}@10.10.10.10:554/cam/realmonitor?channel=1&subtype=0
      back_sub:
        - ffmpeg:back#video=h264#width=1280#height=720#raw=-fpsmax 5#hardware=vaapi
    webrtc:
      candidates:
        - 10.10.100.2:8555
        - 100.68.7.50:8555
        - stun:8555
  ffmpeg:
    hwaccel_args: preset-intel-qsv-h264
  cameras:
    front:
      ffmpeg:
        inputs:
          - path: rtsp://127.0.0.1:8554/front
            input_args: preset-rtsp-restream
            roles:
              - record
          - path: rtsp://127.0.0.1:8554/front_sub
            input_args: preset-rtsp-restream
            roles:
              - detect
      detect:
        enabled: true
        width: 1280
        height: 720
      motion:
        mask:
          - 0.753,0.043,0.753,0.08,0.964,0.081,0.963,0.037
          - 1,0.605,0.961,0.608,0.962,0.532,0.925,0.558,0.903,0.505,0.909,0.45,0.87,0.41,0.858,0.392,0.848,0.39,0.84,0.372,0.834,0.346,0.817,0.333,0.816,0.307,0.808,0.276,0.809,0.219,0.813,0.186,0.826,0.159,0.829,0.123,0.847,0.1,0.872,0.1,0.875,0.063,0.902,0.04,0.919,0,1,0
      zones:
        street:
          coordinates: 0.158,0.305,0.384,0.264,0.497,0.247,0.607,0.24,0.752,0.242,0.862,0.248,0.86,0.338,0.75,0.344,0.657,0.351,0.484,0.371,0.374,0.386,0.172,0.429
          objects:
            - person
            - car
        driveway:
          coordinates: 0.7,0.433,0.677,0.417,0.66,0.406,0.65,0.396,0.646,0.382,0.654,0.367,0.394,0.398,0.413,0.404,0.428,0.411,0.444,0.43,0.462,0.453,0.473,0.466
        front_yard:
          coordinates: 0.466,0.495,0.795,0.429,1,0.625,1,1,0.691,1,0.562,0.768,0.582,0.707
        balcony:
          coordinates: 0.66,1,0.299,0.311,0.167,0.344,0.171,0.404,0.181,0.58,0.197,0.781,0.222,1
          objects:
            - person
      review:
        alerts:
          labels:
            - person
            - car
            - cat
          required_zones:
            - driveway
            - front_yard
            - balcony
        detections:
          labels:
            - person
            - car
          required_zones:
            - street
            - front_yard
            - balcony
    back:
      ffmpeg:
        inputs:
          - path: rtsp://127.0.0.1:8554/back
            input_args: preset-rtsp-restream
            roles:
              - record
          - path: rtsp://127.0.0.1:8554/back_sub
            input_args: preset-rtsp-restream
            roles:
              - detect
      detect:
        enabled: true
        width: 1280
        height: 720
      motion:
        mask:
          - 0,0.929,0.083,0.852,0.054,0.76,0.097,0.732,0.115,0.779,0.149,0.782,0.148,0.669,0.184,0.641,0.193,0.596,0.208,0.567,0.216,0.502,0.268,0.437,0.251,0.364,0.222,0.376,0.211,0.35,0.222,0.319,0.236,0.272,0.247,0.227,0.223,0.194,0.233,0.164,0.229,0.092,0.235,0,0,0
          - 0.087,0.743,0.131,0.91,0.116,0.973,0.094,0.977,0.077,0.867,0.067,0.772,0.067,0.725
          - 0.035,0.77,0.066,0.899,0.079,0.956,0.044,0.975,0.031,0.963,0.021,0.872,0.022,0.825
          - 0.753,0.042,0.754,0.079,0.964,0.083,0.964,0.04
      review:
        alerts:
          labels:
            - person
            - cat
        detections:
          labels:
            - car
image:
  repository: ghcr.io/blakeblackshear/frigate
  tag: 0.16.2
persistence:
  media:
    enabled: true
    size: 700Gi
    storageClass: nfs-csi
    skipuninstall: true
  config:
    enabled: true
    size: 512Mi
    storageClass: longhorn
    skipuninstall: true
    ephemeralWritableConfigYaml: true
securityContext:
  capabilities:
    add:
      - PERFMON
resources:
  limits:
    gpu.intel.com/i915: 1
shmSize: 128Mi
envFromSecrets:
  - frigate-secrets
ingress:
  enabled: true
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt
  hosts:
    - host: frigate.hs.liquid.sh
      paths:
          # since the frigate chart doesn't allow to set a Prefix pathType,
          # the path needs to be specified as a regex
          # (which is what the cilium ingress treats ImplementationSpecific as)
        - path: /.*
          portName: http-auth
  tls:
    - hosts:
        - frigate.hs.liquid.sh
      secretName: tls-frigate-ingress
